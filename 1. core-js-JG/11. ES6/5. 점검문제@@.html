<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>

<body>

  <script>
    const traders = [{
        trader: {
          name: "김철수",
          city: "대전",
        },
        year: 2023,
        value: 500000,
      },
      {
        trader: {
          name: "박영희",
          city: "서울",
        },
        year: 2022,
        value: 600000,
      },
      {
        trader: {
          name: "김철수",
          city: "대전",
        },
        year: 2022,
        value: 1200000,
      },
      {
        trader: {
          name: "박영희",
          city: "서울",
        },
        year: 2023,
        value: 650000,
      },
      {
        trader: {
          name: "뽀로로",
          city: "부산",
        },
        year: 2023,
        value: 800000,
      },
      {
        trader: {
          name: "루피",
          city: "대전",
        },
        year: 2022,
        value: 780000,
      },
    ];

   



    


    /* 내가 한것
    traders
      .filter(a => a.trader[year] === 2022)
      .map(a => `거래자 이름${a.name}, 거래자 도시${a.city}`)
      .forEach(aa => console.log(aa));
    */

    // 연습 1: 2022년에 발생한 모든 거래를 찾아
    //   거래자 정보(이름, 도시)를 배열에 매핑해주세요
    traders
      .filter(trs => trs.year === 2022)
      .map(trs => trs.trader)
      .forEach(trs => console.log(trs)); //변수 이름 상관없음?


    console.log('---------------------------');
    /* 내가 한것
    traders
      .map(b => {
        return {
          city: b.trader[city]
        }
      })
      .forEach(b => console.log(`${b.city}`));
    */
   
    // 연습 2: 거래자가 근무하는 모든 도시이름을 배열에 담아주세요.
    const mappedCities = traders.map(trs => trs.trader.city) // 변수로 처리
    console.log(mappedCities);
    //mappedCities.forEach(city => console.log(city));


    console.log('---------------------------');
    /* 내가 한것
    traders.trader
      .filter(c => c.trader[city] === '대전')
      .map(c => {
        return {
          name3: c.name,
          city3: c.city
        }
      })
      .forEach(cc => console.log(`${c.name3}${c.city3}`));
    */
    // 연습 3: 대전에 근무하는
    // 모든 거래자를 찾아 거래자정보(이름, 도시)를 배열에 매핑해주세요.
    traders
      .filter(trs => trs.trader.city === '대전')
      .map(trs => trs.trader)
      .forEach(trs => console.log(trs));



    console.log('---------------------------');
    /* 내가 한것
    traders
      .map(d => {
        return {
          trader
        }
      })
      .forEach(dd => console.log(`${d.trader}`));
    */
    // 연습 4: 모든 거래자의 이름을 배열에 모아주세요.
    const mappedNames = traders.map(trs => trs.trader.name); //오타 trader는 정의 된 함수 x
    const names = new Set(mappedNames); // 집합요소 Set : 중복 제거
    console.log(names);
    //console.log(mappedNames);


    console.log('---------------------------');
    /* 내가 한것
    traders
      let sum = 0;
      .filter(e => e.trader[city]==='서울')
      .map(e => sum += value)
      .forEach(ee => console.log(`${e}`));
    */

    /*
    let total = 0;
    traders
      .filter(trs => trs.trader.city === '서울')
      //.forEach(trs => total += trs.value); //한줄 표현
      .map(trs => trs.value) //두번 쪼갬
      .forEach(val => total += val);
      
    console.log(`거래총액 : ${total}원`);
    */
    

    // 연습 5: 서울에 사는 거래자의 모든 거래액의 총합 출력.
    // reduce 함수 : 배열을 반복해서 각 요소에 콜백함수를 적용한 결과를 누적하는 함수

    /*
    let total = 0;
    traders
      .filter(trs => trs.trader.city === '서울')
      // 1번 .forEach(trs => total += trs.value);
      // 2번 .map(trs => trs.value)
      // 2번 .forEach(val => total += val);
    */

    // reduce 함수: 배열을 반복해서 각 요소에 콜백함수를 적용한
    //             결과를 누적하는 함수
    /*
      array.reduce((누적값, 배열 요소) => 반복해서 실행할 내용(누적연산), acc의 초기값);
    */
    
    
    const total = traders
      .filter(trs => trs.trader.city === '서울') // 콜백함수
      .reduce((acc, curr) => acc + curr.value, 0)
      // array.reduce((누적값, 배열요소) => 반복해서 실행할 내용(누적연산), acc의 초기값);

    console.log(`거래총액 : ${total}원`);



  </script>

</body>

</html>